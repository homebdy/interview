일반적으로 mysql의 기본 격리수준인 repeatable read 에서는 phantom read가 발생하지 않는다.

그 이유는 넥스트키락(갭락) 덕분인데 잠금을 걸고 읽게되면 해당 레코드를 잠그고 레코드와 레코드 사이까지 잠그게된다.

더 정확히는 innoDB는 레코드를 잠그지 않고 레코드의 인덱스를 잠근다.

그렇기 때문에 select for update로 인덱스를 잠근 뒤 읽게되면 갭락이 발생해 다른 트랜잭션은 새로운 레코드 삽입에 실패한다.

하지만 유일하게 팬텀리드가 발생하는 경우가 한 가지 있다.

첫 번째 조회시 잠금 없는 읽기를 수행한 뒤 두 번째 조회에서 인덱스를 잠근뒤 읽는 경우를 가정해보자.

첫 번째 조회 시 1개의 결과가 반환되고 그 사이 다른 트랜잭션이 새로운 행을 삽입한다면

넥스트키락이 없기때문에 새로운 행이 삽입된다.

즉 넥스트 키락이 언두영역까지는 잠글 수 없기때문에 두 번째 읽기에서 언두영역이 아닌 현재 반영된 레코드에서 값을 가져오기때문에 팬텀리드가 발생한다.

하지만 정말 예외적인 상황이다.
